(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28330,        654]
NotebookOptionsPosition[     27486,        625]
NotebookOutlinePosition[     27993,        645]
CellTagsIndexPosition[     27950,        642]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7212869609777584`*^9, 3.7212870038343525`*^9}, {
  3.7212871500486436`*^9, 3.7212871548484*^9}, {3.7212873019350824`*^9, 
  3.721287302390587*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "50"}], ";", 
  RowBox[{"(*", 
   RowBox[{"\:041a\:043e\:043b", "-", 
    RowBox[{
    "\:0432\:043e", " ", "\:043a\:043e\:043d\:0435\:0447\:043d\:044b\:0445", 
     " ", "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:043e\:0432"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"h", "=", 
   RowBox[{"L", "/", "n"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "\:0428\:0430\:0433", " ", "\:043f\:043e", " ", 
    "\:0441\:0442\:0435\:0440\:0436\:043d\:044e"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"k", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"k", " ", "h"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6839882970642467`*^9, 3.6839883048646774`*^9}, {
   3.683988368207019*^9, 3.6839884184869146`*^9}, {3.6839885321742153`*^9, 
   3.683988566718122*^9}, {3.683988660157132*^9, 3.6839886637569933`*^9}, {
   3.683988832307558*^9, 3.683988833916089*^9}, {3.6840266009690127`*^9, 
   3.684026601216076*^9}, {3.684402340198732*^9, 3.6844023529146566`*^9}, {
   3.6852854234234176`*^9, 3.685285424329734*^9}, 3.6853261766547723`*^9, 
   3.6859402952531986`*^9, {3.685940361383314*^9, 3.685940376069812*^9}, 
   3.6859406702247715`*^9, 3.685940720277388*^9, {3.6859743218472786`*^9, 
   3.685974333135231*^9}, {3.685974930699812*^9, 3.685974952690638*^9}, 
   3.6860603583964276`*^9, {3.6861182785041656`*^9, 3.686118300874605*^9}, 
   3.6861201413814383`*^9, {3.6861210152325726`*^9, 3.686121027852995*^9}, {
   3.686121347809557*^9, 3.686121391598834*^9}, {3.68612165126129*^9, 
   3.6861216515576906`*^9}, 3.6861219802034674`*^9, {3.6861220324011593`*^9, 
   3.6861220325727596`*^9}, {3.6861228547878036`*^9, 3.686122855474205*^9}, 
   3.686122957779185*^9, {3.686124251707301*^9, 3.686124252424903*^9}, {
   3.6882595123509035`*^9, 3.6882595423687067`*^9}, {3.6882602951577177`*^9, 
   3.6882602957671366`*^9}, {3.688260439246297*^9, 3.6882604549505653`*^9}, {
   3.6882607890327373`*^9, 3.68826081028428*^9}, {3.688261013439649*^9, 
   3.6882610169867816`*^9}, {3.6883060822585287`*^9, 3.6883061186115*^9}, {
   3.688306210347274*^9, 3.6883062118415995`*^9}, {3.6883064098325777`*^9, 
   3.6883064150483093`*^9}, 3.6883104288534393`*^9, {3.6883810865047245`*^9, 
   3.6883812489227657`*^9}, 3.688382615868434*^9, {3.6883826826857834`*^9, 
   3.6883827035935507`*^9}, 3.688382986191594*^9, 3.6883830302416663`*^9, {
   3.688383090011629*^9, 3.6883830911054587`*^9}, 3.6883861689608903`*^9, {
   3.688389344445196*^9, 3.6883893595109053`*^9}, {3.689155902580384*^9, 
   3.689155903221055*^9}, {3.6891559415145597`*^9, 3.689155960913855*^9}, {
   3.6892608367758656`*^9, 3.689260846336267*^9}, {3.6892608993594227`*^9, 
   3.689260921108236*^9}, {3.6913148265623603`*^9, 3.691314837248876*^9}, 
   3.691549799293367*^9, {3.691828037154843*^9, 3.691828038512045*^9}, {
   3.696420281302479*^9, 3.696420300288192*^9}, {3.6964242417566285`*^9, 
   3.6964242482258344`*^9}, {3.7000619548739543`*^9, 3.7000619702008266`*^9}, 
   3.7001309605342016`*^9, 3.7001485560436034`*^9, 3.7006174079276304`*^9, 
   3.7006175267799687`*^9, 3.7022177982898293`*^9, {3.702218138599639*^9, 
   3.702218146006976*^9}, {3.702218390605522*^9, 3.7022183992054005`*^9}, 
   3.702221053379318*^9, 3.7026082275555167`*^9, 3.7028049267068367`*^9, 
   3.705152770684689*^9, 3.70519572599226*^9, 3.7052014732718873`*^9, 
   3.7052022753230524`*^9, 3.7052031186858044`*^9, 3.7052038736278486`*^9, 
   3.7176710857797546`*^9, {3.7176800106550293`*^9, 3.7176800107741423`*^9}, {
   3.7176814873984365`*^9, 3.7176814883022575`*^9}, {3.717681532886259*^9, 
   3.7176815329977274`*^9}, 3.7176816807971363`*^9, 3.7176818427985897`*^9, 
   3.719666574152168*^9, 3.7202360423857145`*^9, {3.7202361387208014`*^9, 
   3.720236142549203*^9}, {3.7202362666362963`*^9, 3.72023627893406*^9}, {
   3.7202438397595224`*^9, 3.7202438434316626`*^9}, 3.7205022013201013`*^9, {
   3.7205022359435654`*^9, 3.720502236295348*^9}, {3.7205031671053247`*^9, 
   3.720503177744156*^9}, {3.7206792621855702`*^9, 3.720679269607977*^9}, {
   3.720680565638369*^9, 3.7206805670915985`*^9}, {3.72068064908185*^9, 
   3.720680654004078*^9}, {3.720687043392028*^9, 3.720687046486*^9}, {
   3.7206879712332444`*^9, 3.7206879733427696`*^9}, {3.7206880569268856`*^9, 
   3.720688078115904*^9}, 3.720688867741824*^9, 3.7210187028899026`*^9, 
   3.7210265075154967`*^9, {3.7210265489559793`*^9, 3.721026549080989*^9}, 
   3.721026712555002*^9, 3.7210944152014065`*^9, 3.7210966182669945`*^9, 
   3.7212935414651074`*^9, {3.721293598928726*^9, 3.7212935990648556`*^9}, {
   3.721304236557706*^9, 3.72130423718935*^9}, {3.721307679687929*^9, 
   3.721307679903945*^9}, {3.7213079401418104`*^9, 3.721307943077505*^9}, {
   3.721308016501297*^9, 3.7213080169332647`*^9}, {3.721308121844319*^9, 
   3.7213081223001933`*^9}, {3.7213082626113124`*^9, 3.721308262962881*^9}, {
   3.721308492194116*^9, 3.7213084952488585`*^9}, {3.7213089311094503`*^9, 
   3.721308932396901*^9}, {3.7213090409801664`*^9, 3.7213090418040457`*^9}, 
   3.721309100323821*^9, {3.7213091546432037`*^9, 3.7213091554833765`*^9}, 
   3.7213094406809983`*^9, 3.7213095836635633`*^9, {3.7218020459650593`*^9, 
   3.721802053043681*^9}, {3.7220583448236036`*^9, 3.722058347011259*^9}, {
   3.722058382013747*^9, 3.7220583851702213`*^9}, 3.7220586770190887`*^9, {
   3.7220611820498204`*^9, 3.722061190722312*^9}, {3.722067647074383*^9, 
   3.722067647177021*^9}, {3.7220683155525675`*^9, 3.722068315646326*^9}, 
   3.7220697405924797`*^9, 3.722071207633729*^9, {3.7220714212541647`*^9, 
   3.722071421379174*^9}, {3.7220714710140305`*^9, 3.7220714734409037`*^9}, {
   3.72207170981028*^9, 3.7220717422107463`*^9}, {3.722071795180299*^9, 
   3.7220717955865774`*^9}, {3.722071966635102*^9, 3.722071968680725*^9}, {
   3.7224402234728746`*^9, 3.7224402235197535`*^9}, {3.7224403522296505`*^9, 
   3.722440354479817*^9}, {3.7228336557556067`*^9, 3.7228336573808203`*^9}, {
   3.722838744051214*^9, 3.722838744144972*^9}, {3.7229090348211308`*^9, 
   3.7229090355887203`*^9}, {3.722910619042142*^9, 3.722910619225789*^9}, {
   3.7229107127232*^9, 3.722910712978904*^9}, 3.722910953780795*^9, {
   3.7229110243374825`*^9, 3.722911024609395*^9}, {3.722912223669365*^9, 
   3.7229122247972608`*^9}, {3.7229124932174473`*^9, 
   3.7229124953128552`*^9}, {3.7229126765153184`*^9, 3.722912676955509*^9}, {
   3.722914081124519*^9, 3.722914081204077*^9}, {3.7229143133879457`*^9, 
   3.7229143136597095`*^9}, 3.7229147169408956`*^9, {3.7229149184216933`*^9, 
   3.7229149191812763`*^9}, 3.7229156022478886`*^9, {3.7229157063974595`*^9, 
   3.7229157066849623`*^9}, 3.7229158983782535`*^9, {3.7229162323878927`*^9, 
   3.7229162326759977`*^9}, 3.7229163798573923`*^9, {3.7358841078797894`*^9, 
   3.73588410814541*^9}, {3.7358882717559953`*^9, 3.7358882730841064`*^9}, {
   3.735960268683749*^9, 3.735960271776435*^9}, {3.7372870633951316`*^9, 
   3.737287063598255*^9}, {3.7373811005760584`*^9, 3.737381100638558*^9}, {
   3.7373814364479227`*^9, 3.7373814365885468`*^9}, {3.737381786594243*^9, 
   3.737381786672367*^9}, {3.737695449034001*^9, 3.737695449090982*^9}, {
   3.737695507401285*^9, 3.7376955077151833`*^9}, 3.737695661000074*^9, {
   3.7376957070875864`*^9, 3.737695707159563*^9}, 3.7376957941032267`*^9, {
   3.737695859086333*^9, 3.7376958593502464`*^9}, 3.7376960089662237`*^9, {
   3.7376960803973556`*^9, 3.737696082108797*^9}, 3.737697407075941*^9, {
   3.737698585003109*^9, 3.737698585298012*^9}, 3.7376990380394*^9, {
   3.7376991546622515`*^9, 3.7376991549331617`*^9}, 3.7376993143161073`*^9, {
   3.73769937053214*^9, 3.7376993706910877`*^9}, 3.7377001442217665`*^9, {
   3.73785673490329*^9, 3.737856735199184*^9}, {3.738581083549777*^9, 
   3.7385810838530016`*^9}, {3.7385833367252584`*^9, 3.738583336893203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"resmod", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["h", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         RowBox[{"x", "[", 
          RowBox[{"i", "-", "1"}], "]"}], 
         RowBox[{"x", "[", "i", "]"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"p", "=", "2"}], 
              RowBox[{"k", "+", "1"}]], 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"i", "-", "p"}], "]"}], 
              RowBox[{
               SubsuperscriptBox["\[Integral]", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "p"}], "]"}], 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "p", "+", "1"}], "]"}]], 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"t", "-", "xx"}], "a"]], 
                RowBox[{"\[DifferentialD]", "t"}]}]}]}]}]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "1"}], "k"], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "-", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "p", "-", "1"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "p"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"t", "-", "xx"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "-", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"i", "-", "1"}], "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"x", "[", 
               RowBox[{"i", "-", "1"}], "]"}], "xx"], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"t", "-", "xx"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "-", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"i", "-", "1"}], "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", "xx", 
              RowBox[{"x", "[", "i", "]"}]], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"xx", "-", "t"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "+", 
           RowBox[{
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"x", "[", 
               RowBox[{"i", "-", "1"}], "]"}], "xx"], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"t", "-", "xx"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "+", 
           RowBox[{
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", "xx", 
              RowBox[{"x", "[", "i", "]"}]], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"xx", "-", "t"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "-", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "0"}], 
             RowBox[{"k", "-", "1"}]], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "+", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p", "+", "1"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"xx", "-", "t"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "1"}], "k"], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "+", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p", "-", "1"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"xx", "-", "t"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}]}], ")"}], 
         RowBox[{"\[DifferentialD]", "xx"}]}]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         RowBox[{"x", "[", "i", "]"}], 
         RowBox[{"x", "[", 
          RowBox[{"i", "+", "1"}], "]"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"p", "=", "1"}], "k"], 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"i", "-", "p"}], "]"}], 
              RowBox[{
               SubsuperscriptBox["\[Integral]", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "p"}], "]"}], 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "p", "+", "1"}], "]"}]], 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 FractionBox[
                  RowBox[{"t", "-", "xx"}], "a"]], 
                RowBox[{"\[DifferentialD]", "t"}]}]}]}]}]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "0"}], 
             RowBox[{"k", "-", "1"}]], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "-", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "p", "-", "1"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "p"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"t", "-", "xx"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "-", 
           RowBox[{
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"x", "[", "i", "]"}], "xx"], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"t", "-", "xx"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "-", 
           RowBox[{
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", "xx", 
              RowBox[{"x", "[", 
               RowBox[{"i", "+", "1"}], "]"}]], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"xx", "-", "t"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "+", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"i", "+", "1"}], "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"x", "[", "i", "]"}], "xx"], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"t", "-", "xx"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "+", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"i", "+", "1"}], "]"}], 
            RowBox[{
             SubsuperscriptBox["\[Integral]", "xx", 
              RowBox[{"x", "[", 
               RowBox[{"i", "+", "1"}], "]"}]], 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"xx", "-", "t"}], "a"]], 
              RowBox[{"\[DifferentialD]", "t"}]}]}]}], "-", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "1"}], "k"], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "+", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p", "+", "1"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"xx", "-", "t"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"p", "=", "2"}], 
             RowBox[{"k", "+", "1"}]], 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i", "+", "p"}], "]"}], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p", "-", "1"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"i", "+", "p"}], "]"}]], 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"xx", "-", "t"}], "a"]], 
               RowBox[{"\[DifferentialD]", "t"}]}]}]}]}]}], ")"}], 
         RowBox[{"\[DifferentialD]", "xx"}]}]}]}], ")"}]}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722058730179117*^9, 3.722058824998356*^9}, {
   3.7220588610946712`*^9, 3.722058868267056*^9}, {3.7220589340842338`*^9, 
   3.722058970039914*^9}, {3.7220590772037807`*^9, 3.722059079516445*^9}, {
   3.722059869190888*^9, 3.722059904677785*^9}, {3.7220599991532497`*^9, 
   3.7220600326087523`*^9}, 3.72206008914402*^9, {3.7220601254278493`*^9, 
   3.722060160727233*^9}, {3.7220602025270786`*^9, 3.722060303721771*^9}, {
   3.722060372211014*^9, 3.7220603740392685`*^9}, {3.7220604261679735`*^9, 
   3.7220604282774982`*^9}, {3.7220604688741336`*^9, 3.722060537222741*^9}, {
   3.7220605761942616`*^9, 3.7220606306512566`*^9}, {3.722060704656516*^9, 
   3.722060786709223*^9}, {3.7220608313998995`*^9, 3.722060834165721*^9}, {
   3.7220614321925983`*^9, 3.7220614547723284`*^9}, {3.722061665410859*^9, 
   3.722061665676503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "i_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", " ", "h"}], ",", 
        RowBox[{"0", "<", "i", "\[LessEqual]", "n"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"i", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7220684217226295`*^9, 3.7220684221157417`*^9}, {
  3.7220691728579483`*^9, 3.7220691747757826`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeflist", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"resmod", ",", 
        RowBox[{"T", "[", 
         RowBox[{"i", "+", "p"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{
         RowBox[{"-", "k"}], "-", "1"}], ",", 
        RowBox[{"k", "+", "1"}], ",", "1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"i", "\[Rule]", 
     RowBox[{"n", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7204320884346733`*^9, 3.7204321550174904`*^9}, {
   3.7204323083876734`*^9, 3.720432317591447*^9}, {3.7205031514652233`*^9, 
   3.720503152696269*^9}, {3.7206794642313013`*^9, 3.7206794650751123`*^9}, {
   3.7206872093726735`*^9, 3.7206872098102055`*^9}, {3.722059090298461*^9, 
   3.7220590930174046`*^9}, {3.7220633742036867`*^9, 3.722063394095725*^9}, {
   3.722067473034955*^9, 3.7220674889611692`*^9}, {3.72206752071861*^9, 
   3.722067570936021*^9}, {3.7220693123009963`*^9, 3.722069315693924*^9}, {
   3.722069366846642*^9, 3.7220693700471573`*^9}, {3.722069511533171*^9, 
   3.722069571680456*^9}, {3.722069665332196*^9, 3.722069709411311*^9}, 
   3.722071783522793*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", "i_", "]"}], ":=", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["T", "i"], ",", 
         RowBox[{"0", "\[LessEqual]", "i", "\[LessEqual]", "n"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"i", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7220691949974313`*^9, 3.7220692465291004`*^9}, {
  3.7220693799578595`*^9, 3.722069381168934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coef0n", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"resmod", "/.", 
          RowBox[{"i", "->", "p"}]}], ",", 
         RowBox[{"T", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"k", "+", "1", "+", "p"}], ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "k", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722069863804493*^9, 3.7220699030141196`*^9}, {
   3.7220699510087423`*^9, 3.722070034761212*^9}, {3.722070071445119*^9, 
   3.722070114744037*^9}, 3.722071768622693*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coef0n", "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.7220701285583687`*^9, 3.722070131898484*^9}, 
   3.722071766482066*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"knloc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", "n"}], "]"}], ",", "n"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7202422450379105`*^9, 3.720242262336035*^9}, {
  3.7202423387634335`*^9, 3.720242397502054*^9}, {3.720502206080241*^9, 
  3.720502305031184*^9}, {3.720503163072402*^9, 3.720503163264594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0421\:0447\:0438\:0442\:0430\:0435\:043c", " ", 
    "\:043c\:0430\:0442\:0440\:0438\:0446\:0443"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"k", "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"i", "+", "k", "+", "1"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"knloc", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"coef0n", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"k", "+", "1"}]}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"n", "-", "k", "-", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", 
         RowBox[{"-", "k"}]}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"k", "+", "2"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"knloc", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"i", "+", "j"}]}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"coeflist", "\[LeftDoubleBracket]", 
           RowBox[{"j", "+", "k", "+", "1"}], "\[RightDoubleBracket]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"k", "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"i", "+", "k", "+", "1"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"knloc", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "-", "i", "+", "1"}], ",", 
           RowBox[{"n", "-", "j", "+", "1"}]}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"coef0n", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.72068707983214*^9, 3.720687174854575*^9}, {
  3.7206874785416803`*^9, 3.72068754599964*^9}, {3.720687764124649*^9, 
  3.720687818941078*^9}, {3.7206881282444973`*^9, 3.7206881333229866`*^9}, {
  3.722070715971361*^9, 3.7220707192771435`*^9}, {3.7220708509042673`*^9, 
  3.722070884246537*^9}, {3.7220709301269293`*^9, 3.722070957429966*^9}, {
  3.722070993961274*^9, 3.7220710451029806`*^9}, {3.7220710856488853`*^9, 
  3.722071129508334*^9}, {3.722071162264258*^9, 3.722071199256988*^9}, {
  3.7220716549232883`*^9, 3.722071682039176*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"knloc", "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.720687832848325*^9, 3.720687838348719*^9}, {
   3.720689224660887*^9, 3.7206892502720976`*^9}, {3.7206892821493826`*^9, 
   3.7206892990724707`*^9}, {3.7210266038036776`*^9, 
   3.7210266070382853`*^9}, {3.7212936204802113`*^9, 3.7212936308080273`*^9}, 
   3.721304242437543*^9, 3.72180206193493*^9, 3.722071203179012*^9, {
   3.7220718063423595`*^9, 3.7220718106226563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<matrix_nloc.dat\>\"", ",", "knloc"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7206881804669905`*^9, 3.7206882193135242`*^9}, {
  3.720689162656443*^9, 3.7206891628439565`*^9}, {3.720689208987889*^9, 
  3.7206893026196*^9}, {3.720758722631601*^9, 3.7207587226628537`*^9}, {
  3.720758754415167*^9, 3.720758755805894*^9}, {3.7220586353286257`*^9, 
  3.72205863679748*^9}, {3.7220718145447245`*^9, 3.722071815949419*^9}}]
},
WindowSize->{958, 988},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.2, 841.8000000000001}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 293, 6, 48, "Input"],
Cell[854, 28, 7885, 116, 112, "Input"],
Cell[8742, 146, 10660, 269, 417, "Input"],
Cell[19405, 417, 527, 15, 48, "Input"],
Cell[19935, 434, 1214, 26, 48, "Input"],
Cell[21152, 462, 583, 18, 31, "Input"],
Cell[21738, 482, 752, 20, 48, "Input"],
Cell[22493, 504, 176, 4, 48, "Input"],
Cell[22672, 510, 405, 9, 48, "Input"],
Cell[23080, 521, 3426, 82, 440, "Input"],
Cell[26509, 605, 480, 8, 48, "Input"],
Cell[26992, 615, 490, 8, 48, "Input"]
}
]
*)

